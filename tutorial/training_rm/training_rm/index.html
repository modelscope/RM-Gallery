
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../data/process/">
      
      
        <link rel="next" href="../../building_rm/custom_reward/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Train RM - RM-Gallery</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#verl-based-reward-model-training-complete-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="RM-Gallery" class="md-header__button md-logo" aria-label="RM-Gallery" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RM-Gallery
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Train RM
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../quick_start/" class="md-tabs__link">
        
  
  
    
  
  Quick Start

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../contribution/" class="md-tabs__link">
        
  
  
    
  
  Contribution

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../data/annotation/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../autoapi/rm_gallery/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="RM-Gallery" class="md-nav__button md-logo" aria-label="RM-Gallery" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    RM-Gallery
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contribution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contribution
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/annotation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Annotation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/load/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Train RM
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Train RM
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      📖 Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      🏗️ System Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🏗️ System Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-training-dataset-inherits-from-basetraindataset" class="md-nav__link">
    <span class="md-ellipsis">
      1. Training Dataset - Inherits from BaseTrainDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-prompt-template-based-on-baseprompttemplate" class="md-nav__link">
    <span class="md-ellipsis">
      2. Prompt Template - Based on BasePromptTemplate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reward-function-customizable-reward-computation-module" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reward Function - Customizable reward computation module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Environment Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Environment Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      System Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runtime-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Runtime Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Quick Start
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚀 Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-prepare-training-data" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Prepare Training Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-launch-ray-distributed-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Launch Ray Distributed Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Launch Ray Distributed Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-node-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Single Node Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-node-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Node Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-choose-training-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Choose Training Mode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Choose Training Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointwise-training-absolute-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      Pointwise Training (Absolute Scoring)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pairwise-training-preference-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Pairwise Training (Preference Comparison)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pointwise-training-detailed-guide" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Pointwise Training Detailed Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📊 Pointwise Training Detailed Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-download" class="md-nav__link">
    <span class="md-ellipsis">
      Data Download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      Data Conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepare-yaml-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare YAML Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      Execute Conversion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-script-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Training Script Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pointwise-core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Pointwise Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pointwise Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-converter" class="md-nav__link">
    <span class="md-ellipsis">
      Data Converter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-template" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-function" class="md-nav__link">
    <span class="md-ellipsis">
      Reward Function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pairwise-training-detailed-guide" class="md-nav__link">
    <span class="md-ellipsis">
      🔄 Pairwise Training Detailed Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔄 Pairwise Training Detailed Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-download_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-conversion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepare-yaml-configuration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare YAML Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-conversion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Execute Conversion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-script-configuration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Training Script Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pairwise-core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Pairwise Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pairwise Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-converter_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Converter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-template_1" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-function_1" class="md-nav__link">
    <span class="md-ellipsis">
      Reward Function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-results-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Training Results &amp; Evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Results &amp; Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-performance-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Model Performance Comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-accuracy-results" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Accuracy Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-dataset-evaluation-rm-bench-results" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Dataset Evaluation: RM-Bench Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-implications" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Implications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-component-details" class="md-nav__link">
    <span class="md-ellipsis">
      🧩 Core Component Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧩 Core Component Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-training-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Training Dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ppo-grpo-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      PPO + GRPO Pipeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Training Monitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📊 Training Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging-and-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Logging and Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-monitoring-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Key Monitoring Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Training Curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      ❓ FAQ &amp; Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="❓ FAQ &amp; Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues-and-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues and Solutions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Issues and Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-num_samples0-error" class="md-nav__link">
    <span class="md-ellipsis">
      1. num_samples=0 error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ray-connection-issues" class="md-nav__link">
    <span class="md-ellipsis">
      2. Ray connection issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-out-of-memory-errors" class="md-nav__link">
    <span class="md-ellipsis">
      3. Out of Memory Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-reasoning-model-configuration-issues" class="md-nav__link">
    <span class="md-ellipsis">
      4. Reasoning Model Configuration Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-helpsteer2-specific-issues" class="md-nav__link">
    <span class="md-ellipsis">
      5. HelpSteer2 Specific Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-optimization-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization Tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Inference &amp; Evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-resources" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Related Resources
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔗 Related Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tutorial-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#framework-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Framework Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset Resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      📝 Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Build RM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Build RM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../docs/tutorial/building_rm/overview.ipynb" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../building_rm/custom_reward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../building_rm/autoprinciple/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Auto Principle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../building_rm/built_in_rewards.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Built-in Rewards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../building_rm/benchmark_practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmark
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rm_servering/rm_server.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RM Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploying_rm/best_of_n.ipynb" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best of N
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploying_rm/post_traning_with_rm.ipynb" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Post Training with RM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploying_rm/refinement.ipynb" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Refinement
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    rm_gallery
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            rm_gallery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2" id="__nav_5_1_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_1" id="__nav_5_1_1_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    annotation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            annotation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/annotation/annotation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    annotation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/annotation/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/annotation/server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/annotation/template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    template
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/build/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    build
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/export/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    export
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_5" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_5" id="__nav_5_1_1_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    load
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_5">
            <span class="md-nav__icon md-icon"></span>
            load
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/load/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/load/chat_message/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    chat_message
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/load/huggingface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    huggingface
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_6" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_6" id="__nav_5_1_1_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    process
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_6">
            <span class="md-nav__icon md-icon"></span>
            process
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_6_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_6_1" id="__nav_5_1_1_2_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_1_2_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_6_1">
            <span class="md-nav__icon md-icon"></span>
            ops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/process/ops/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_6_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_6_1_2" id="__nav_5_1_1_2_6_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    filter
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_5_1_1_2_6_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_6_1_2">
            <span class="md-nav__icon md-icon"></span>
            filter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/process/ops/filter/conversation_turn_filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    conversation_turn_filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/process/ops/filter/text_length_filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    text_length_filter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/process/process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/data/schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    schema
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_3" id="__nav_5_1_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    model
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/model/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/model/huggingface_llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    huggingface_llm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/model/message/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    message
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/model/openai_llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    openai_llm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_4" id="__nav_5_1_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    reward
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            reward
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_4_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_4_1" id="__nav_5_1_1_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/application/refinement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    refinement
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/composition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    composition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_4_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_4_4" id="__nav_5_1_1_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    principle
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_4_4">
            <span class="md-nav__icon md-icon"></span>
            principle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/principle/auto_rule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    auto_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/principle/filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/principle/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/principle/iter_cum_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    iter_cum_generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/principle/iter_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    iter_generator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/reward/template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    template
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_5" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_5" id="__nav_5_1_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    train
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            train
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/train/dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dataset
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_6" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_6" id="__nav_5_1_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/utils/acc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    acc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/utils/file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/utils/logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    logger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/utils/text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    text
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/core/utils/tokenizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tokenizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    gallery
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            gallery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_1" id="__nav_5_1_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_1_1" id="__nav_5_1_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    annotation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            annotation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/annotation/rewardbench/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rewardbench
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/annotation/rewardbench2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rewardbench2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_1_2" id="__nav_5_1_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    load
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            load
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/helpsteer2_pairwise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    helpsteer2_pairwise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/helpsteer2_pointwise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    helpsteer2_pointwise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/prmbench/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    prmbench
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/rewardbench/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rewardbench
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/rewardbench2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rewardbench2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/rmbbenchmark_bestofn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rmbbenchmark_bestofn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/data/load/rmbbenchmark_pairwise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rmbbenchmark_pairwise
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2" id="__nav_5_1_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    rm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            rm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_1" id="__nav_5_1_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    alignment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            alignment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_1_2" id="__nav_5_1_2_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    harmlessness
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_2_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            harmlessness
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/harmlessness/detoxification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    detoxification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/harmlessness/safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    safety
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_1_3" id="__nav_5_1_2_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    helpfulness
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_2_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            helpfulness
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/brainstorming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    brainstorming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/chat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    chat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    classification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/closed_qa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    closed_qa
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/focus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    focus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    math
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/open_qa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    open_qa
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/precise_if/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    precise_if
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/reasoning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    reasoning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/rewrite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rewrite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/role_playing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    role_playing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/summarization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    summarization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/helpfulness/translation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    translation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_1_4" id="__nav_5_1_2_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    honesty
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_2_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            honesty
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/alignment/honesty/factuality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    factuality
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/carmo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    carmo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_3" id="__nav_5_1_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    code
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/code/code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_3_2" id="__nav_5_1_2_2_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    prime_code
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_2_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            prime_code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/code/prime_code/testing_util/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    testing_util
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/code/prime_code/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_4" id="__nav_5_1_2_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    format
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            format
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/format/format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    format
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    general
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_2_2_6" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2_6" id="__nav_5_1_2_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    math
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoapi/rm_gallery/gallery/rm/math/math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    math
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      📖 Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      🏗️ System Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🏗️ System Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-training-dataset-inherits-from-basetraindataset" class="md-nav__link">
    <span class="md-ellipsis">
      1. Training Dataset - Inherits from BaseTrainDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-prompt-template-based-on-baseprompttemplate" class="md-nav__link">
    <span class="md-ellipsis">
      2. Prompt Template - Based on BasePromptTemplate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reward-function-customizable-reward-computation-module" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reward Function - Customizable reward computation module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Environment Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Environment Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      System Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runtime-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Runtime Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Quick Start
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚀 Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-prepare-training-data" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Prepare Training Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-launch-ray-distributed-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Launch Ray Distributed Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Launch Ray Distributed Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-node-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Single Node Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-node-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Node Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-choose-training-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Choose Training Mode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Choose Training Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointwise-training-absolute-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      Pointwise Training (Absolute Scoring)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pairwise-training-preference-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Pairwise Training (Preference Comparison)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pointwise-training-detailed-guide" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Pointwise Training Detailed Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📊 Pointwise Training Detailed Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-download" class="md-nav__link">
    <span class="md-ellipsis">
      Data Download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      Data Conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepare-yaml-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare YAML Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      Execute Conversion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-script-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Training Script Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pointwise-core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Pointwise Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pointwise Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-converter" class="md-nav__link">
    <span class="md-ellipsis">
      Data Converter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-template" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-function" class="md-nav__link">
    <span class="md-ellipsis">
      Reward Function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pairwise-training-detailed-guide" class="md-nav__link">
    <span class="md-ellipsis">
      🔄 Pairwise Training Detailed Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔄 Pairwise Training Detailed Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-download_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-conversion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepare-yaml-configuration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare YAML Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-conversion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Execute Conversion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-script-configuration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Training Script Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pairwise-core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Pairwise Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pairwise Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-converter_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Converter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-template_1" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-function_1" class="md-nav__link">
    <span class="md-ellipsis">
      Reward Function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-results-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Training Results &amp; Evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Results &amp; Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-performance-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Model Performance Comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-accuracy-results" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Accuracy Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-dataset-evaluation-rm-bench-results" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Dataset Evaluation: RM-Bench Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-implications" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Implications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-component-details" class="md-nav__link">
    <span class="md-ellipsis">
      🧩 Core Component Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧩 Core Component Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-training-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Training Dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ppo-grpo-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      PPO + GRPO Pipeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Training Monitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📊 Training Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging-and-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Logging and Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-monitoring-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Key Monitoring Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Training Curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      ❓ FAQ &amp; Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="❓ FAQ &amp; Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues-and-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues and Solutions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Issues and Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-num_samples0-error" class="md-nav__link">
    <span class="md-ellipsis">
      1. num_samples=0 error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ray-connection-issues" class="md-nav__link">
    <span class="md-ellipsis">
      2. Ray connection issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-out-of-memory-errors" class="md-nav__link">
    <span class="md-ellipsis">
      3. Out of Memory Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-reasoning-model-configuration-issues" class="md-nav__link">
    <span class="md-ellipsis">
      4. Reasoning Model Configuration Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-helpsteer2-specific-issues" class="md-nav__link">
    <span class="md-ellipsis">
      5. HelpSteer2 Specific Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-optimization-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization Tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Inference &amp; Evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-resources" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Related Resources
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔗 Related Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tutorial-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#framework-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Framework Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset Resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      📝 Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="verl-based-reward-model-training-complete-guide">VERL-based Reward Model Training Complete Guide</h1>
<h2 id="overview">📖 Overview</h2>
<p>This document provides a comprehensive guide for training reward models using the VERL framework. Through this tutorial, you will learn how to configure the environment, prepare data, design reward functions, and execute the training pipeline.</p>
<p>This guide covers two main training approaches:
- <strong>Pointwise Training</strong>: Absolute scoring based on individual responses (0-4 scale)
- <strong>Pairwise Training</strong>: Relative preference judgments based on response comparisons</p>
<p>We will use the HelpSteer2 dataset as concrete examples, providing end-to-end implementation demonstrations.</p>
<h2 id="system-architecture">🏗️ System Architecture</h2>
<h3 id="core-components">Core Components</h3>
<p>The VERL reward model training system consists of three core components:</p>
<h4 id="1-training-dataset-inherits-from-basetraindataset">1. <strong>Training Dataset</strong> - Inherits from <code>BaseTrainDataset</code></h4>
<ul>
<li>Supports 0-4 scale helpfulness scoring (Pointwise)</li>
<li>Supports preference comparison evaluation (Pairwise)</li>
<li>Provides flexible conversation template system</li>
<li>Integrates custom reward functions</li>
</ul>
<h4 id="2-prompt-template-based-on-baseprompttemplate">2. <strong>Prompt Template</strong> - Based on <code>BasePromptTemplate</code></h4>
<ul>
<li>Defines structured output format for scoring</li>
<li>Supports extensible scoring criteria</li>
<li>Adapts to different evaluation tasks</li>
</ul>
<h4 id="3-reward-function-customizable-reward-computation-module">3. <strong>Reward Function</strong> - Customizable reward computation module</h4>
<ul>
<li>Supports exponential decay reward calculation</li>
<li>Provides flexible evaluation metric configuration</li>
<li>Real-time accuracy and MAE statistics</li>
</ul>
<h2 id="environment-configuration">🔧 Environment Configuration</h2>
<h3 id="system-requirements">System Requirements</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Recommended Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td>≥ 3.10</td>
</tr>
<tr>
<td>CUDA</td>
<td>≥ 12.1</td>
</tr>
<tr>
<td>PyTorch</td>
<td>≥ 2.1</td>
</tr>
<tr>
<td>Ray</td>
<td>≥ 2.9</td>
</tr>
<tr>
<td>VERL</td>
<td>≥ 0.4.0</td>
</tr>
<tr>
<td>VLLM</td>
<td>≥ 0.8.4</td>
</tr>
</tbody>
</table>
<h3 id="runtime-configuration">Runtime Configuration</h3>
<p>Create a <code>runtime_env.yaml</code> configuration file:</p>
<pre><code class="language-yaml"># runtime_env.yaml
excludes: [&quot;/.git/&quot;]
env_vars:
  TORCH_NCCL_AVOID_RECORD_STREAMS: &quot;1&quot;
  PYTORCH_CUDA_ALLOC_CONF: &quot;expandable_segments: False&quot;
  WANDB_API_KEY: &quot;your_wandb_api_key&quot;
  WANDB_BASE_URL: &quot;your_wandb_base_url&quot;
  HYDRA_FULL_ERROR: &quot;1&quot;
</code></pre>
<h3 id="dependency-installation">Dependency Installation</h3>
<p>Ensure the following core dependencies are installed:
- <code>verl==0.4.0</code> (core framework)
- <code>ray&gt;=2.9</code> (distributed computing)
- <code>vllm&gt;=0.8.4</code> (inference engine)
- <code>torch&gt;=2.1</code> (deep learning framework)</p>
<hr />
<h2 id="quick-start">🚀 Quick Start</h2>
<h3 id="step-1-prepare-training-data">Step 1: Prepare Training Data</h3>
<p>Training data should conform to the <code>DataSample</code> format specification. For detailed data loading and preprocessing steps, please refer to the data loading section.</p>
<h3 id="step-2-launch-ray-distributed-cluster">Step 2: Launch Ray Distributed Cluster</h3>
<h4 id="single-node-setup">Single Node Setup</h4>
<p>Example for a <strong>single node with 8 × A100</strong>:</p>
<pre><code class="language-bash">ray start --head --node-ip-address $MASTER_ADDR --num-gpus 8 --dashboard-host 0.0.0.0
</code></pre>
<h4 id="multi-node-setup">Multi-Node Setup</h4>
<p><strong>Master Node:</strong></p>
<pre><code class="language-bash">ray start --head --node-ip-address $MASTER_ADDR --num-gpus 8
</code></pre>
<p><strong>Worker Nodes:</strong></p>
<pre><code class="language-bash">ray start --address=$MASTER_ADDR:6379 --num-gpus 8
</code></pre>
<h3 id="step-3-choose-training-mode">Step 3: Choose Training Mode</h3>
<p>Select the appropriate training mode based on your needs:</p>
<h4 id="pointwise-training-absolute-scoring">Pointwise Training (Absolute Scoring)</h4>
<pre><code class="language-bash">cd examples/train/pointwise
chmod +x run_pointwise.sh
./run_pointwise.sh
</code></pre>
<h4 id="pairwise-training-preference-comparison">Pairwise Training (Preference Comparison)</h4>
<pre><code class="language-bash">cd examples/train/pairwise
chmod +x run_pairwise.sh
./run_pairwise.sh
</code></pre>
<hr />
<h2 id="pointwise-training-detailed-guide">📊 Pointwise Training Detailed Guide</h2>
<blockquote>
<p>Pointwise training is suitable for absolute scoring scenarios, such as HelpSteer2's 0-4 scale helpfulness scoring.</p>
</blockquote>
<h3 id="data-download">Data Download</h3>
<p>HelpSteer2 dataset: <a href="https://huggingface.co/datasets/nvidia/helpsteer2">https://huggingface.co/datasets/nvidia/helpsteer2</a></p>
<pre><code class="language-bash"># Create data directory
mkdir -p ~/data/HelpSteer2 &amp;&amp; cd ~/data/HelpSteer2

# Download dataset
git clone https://huggingface.co/datasets/nvidia/helpsteer2
</code></pre>
<h3 id="data-conversion">Data Conversion</h3>
<h4 id="prepare-yaml-configuration">Prepare YAML Configuration</h4>
<p><code>examples/train/pointwise/data_config.yaml</code>:</p>
<pre><code class="language-yaml">dataset:
  name: helpsteer2_pointwise
  configs:
    type: local
    source: helpsteer2_pointwise
    path: ~/data/HelpSteer2/helpsteer2
  export:
    output_dir: ./examples/data/exports
    formats: [&quot;parquet&quot;]
    preserve_structure: true
    split_ratio: {train: 0.8, test: 0.2}
</code></pre>
<h4 id="execute-conversion">Execute Conversion</h4>
<pre><code class="language-bash">python examples/data/data_from_yaml.py \
       --config examples/train/pointwise/data_config.yaml
</code></pre>
<h3 id="training-script-configuration">Training Script Configuration</h3>
<p>Check key configurations in <code>examples/train/pointwise/run_pointwise.sh</code>:</p>
<pre><code class="language-bash">TRAIN_FILE=./examples/data/exports/helpsteer2_train.parquet
VAL_FILE=./examples/data/exports/helpsteer2_test.parquet
MODEL_PATH=/path/to/your/base/model  # e.g., Qwen3-8B
</code></pre>
<h3 id="pointwise-core-components">Pointwise Core Components</h3>
<h4 id="data-converter">Data Converter</h4>
<ul>
<li>File: <code>rm_gallery/gallery/data/load/helpsteer2_pointwise.py</code></li>
<li>Class: <code>HelpSteer2PointwiseConverter</code></li>
<li>Function: Convert raw HelpSteer2 data to <code>DataSample</code> with helpfulness scores</li>
</ul>
<h4 id="prompt-template">Prompt Template</h4>
<pre><code class="language-python">class PointwiseTrainTemplate(BasePromptTemplate):
    score: int = Field(default=..., description=&quot;helpfulness score from 0 to 4&quot;)
</code></pre>
<h4 id="reward-function">Reward Function</h4>
<pre><code class="language-python">def pointwise_reward(predicted_score, true_score):
    &quot;&quot;&quot;Reward function optimized for HelpSteer2's 0-4 scale&quot;&quot;&quot;
    if true_score is None:
        return 0.0

    abs_error = abs(predicted_score - true_score)
    max_error = 4  # HelpSteer2 scale: 0-4

    k = 2.0  # Decay coefficient
    error_ratio = abs_error / max_error
    reward = math.exp(-k * error_ratio)

    return float(reward)
</code></pre>
<hr />
<h2 id="pairwise-training-detailed-guide">🔄 Pairwise Training Detailed Guide</h2>
<blockquote>
<p>Pairwise training is suitable for preference comparison scenarios, judging which of two responses is better.</p>
</blockquote>
<h3 id="data-download_1">Data Download</h3>
<p>HelpSteer2 preference dataset: <a href="https://huggingface.co/datasets/nvidia/HelpSteer2/tree/main/preference">https://huggingface.co/datasets/nvidia/HelpSteer2/tree/main/preference</a></p>
<pre><code class="language-bash"># Create data directory
mkdir -p ~/data/HelpSteer2 &amp;&amp; cd ~/data/HelpSteer2

# Download preference data
wget -c https://huggingface.co/datasets/nvidia/HelpSteer2/resolve/main/preference/preference.jsonl.gz

# Extract (keep original file)
gunzip -k preference.jsonl.gz
</code></pre>
<h3 id="data-conversion_1">Data Conversion</h3>
<h4 id="prepare-yaml-configuration_1">Prepare YAML Configuration</h4>
<p><code>examples/train/pairwise/data_config.yaml</code>:</p>
<pre><code class="language-yaml">dataset:
  name: helpsteer2_pairwise
  configs:
    type: local
    source: helpsteer2_pairwise
    path: ~/data/HelpSteer2/preference/preference.jsonl
  export:
    output_dir: ./examples/data/exports
    formats: [&quot;parquet&quot;]
    preserve_structure: true
    split_ratio: {train: 0.8, test: 0.2}
</code></pre>
<h4 id="execute-conversion_1">Execute Conversion</h4>
<pre><code class="language-bash">python examples/data/data_from_yaml.py \
       --config examples/train/pairwise/data_config.yaml
</code></pre>
<h3 id="training-script-configuration_1">Training Script Configuration</h3>
<p>Check key configurations in <code>examples/train/pairwise/run_pairwise.sh</code>:</p>
<pre><code class="language-bash">TRAIN_FILE=./examples/data/exports/preference_train.parquet
VAL_FILE=./examples/data/exports/preference_test.parquet
MODEL_PATH=/path/to/your/base/model
</code></pre>
<h3 id="pairwise-core-components">Pairwise Core Components</h3>
<h4 id="data-converter_1">Data Converter</h4>
<ul>
<li>File: <code>rm_gallery/gallery/data/load/helpsteer2_pairwise.py</code></li>
<li>Class: <code>HelpSteer2PairwiseConverter</code></li>
<li>Function: Convert raw JSONL to <code>DataSample</code> and create both forward &amp; reverse preference pairs</li>
</ul>
<p>Conversion Logic:
1. Read <code>prompt</code>, <code>response_1</code>, <code>response_2</code>, <code>preference_strength</code>
2. Determine preference (&gt;0 → <code>response_2</code> is better, &lt;0 → <code>response_1</code> is better, 0 → tie)
3. Generate two samples (forward + reverse order)</p>
<h4 id="prompt-template_1">Prompt Template</h4>
<pre><code class="language-python">class PairwiseComparisonTemplate(BasePromptTemplate):
    think: str       # (optional) chain-of-thought
    preference: str  # A / B / tie

# Example output format:
# &lt;think&gt;...&lt;/think&gt;
# &lt;preference&gt;A&lt;/preference&gt;
</code></pre>
<h4 id="reward-function_1">Reward Function</h4>
<ul>
<li>File: <code>examples/train/pairwise/reward_fn.py</code></li>
<li>Core Function: <code>compute_score()</code></li>
</ul>
<p>Processing Flow:
1. Parse model output with <code>extract_preference_from_response(solution_str)</code>
2. Compare with <code>metadata.preferred</code> to produce reward: 1.0 (correct) / 0.0 (wrong)</p>
<h3 id="training-results-evaluation">Training Results &amp; Evaluation</h3>
<h4 id="model-performance-comparison">Model Performance Comparison</h4>
<p>We conducted pairwise training experiments using two different base models on the HelpSteer2 preference dataset:</p>
<ul>
<li><strong>Qwen2.5-14B</strong>: Traditional language model</li>
<li><strong>Qwen3-14B</strong>: Reasoning-enhanced model</li>
</ul>
<h4 id="validation-accuracy-results">Validation Accuracy Results</h4>
<p><img alt="HelpSteer2 Pairwise Training Accuracy" src="../../../images/building_rm/helpsteer2_pairwise_training_eval_accuracy.png" /></p>
<p>The training curves show validation accuracy on the test dataset over 350 training steps:</p>
<p><strong>Key Observations:</strong></p>
<ol>
<li><strong>Qwen3-14B Performance</strong> (Orange line):</li>
<li>Achieves higher overall accuracy (~0.62)</li>
<li>More stable training progression</li>
<li>Better convergence characteristics</li>
<li>
<p>Consistent performance throughout training</p>
</li>
<li>
<p><strong>Qwen2.5-14B Performance</strong> (Blue line):</p>
</li>
<li>Slightly lower accuracy (~0.61)</li>
<li>More volatile training curve with occasional drops</li>
<li>Shows improvement in later training stages</li>
<li>
<p>Reasonable final performance despite fluctuations</p>
</li>
<li>
<p><strong>Comparative Analysis</strong>:</p>
</li>
<li><strong>Accuracy Gap</strong>: ~1% difference favoring Qwen3-14B</li>
<li><strong>Stability</strong>: Qwen3-14B demonstrates superior training stability</li>
<li><strong>Convergence</strong>: Both models show good learning progression</li>
<li><strong>Final Performance</strong>: Both achieve &gt;60% accuracy on preference prediction</li>
</ol>
<h4 id="cross-dataset-evaluation-rm-bench-results">Cross-Dataset Evaluation: RM-Bench Results</h4>
<p>To further validate the robustness of our trained models, we evaluated the same Qwen2.5-14B model (trained on HelpSteer2 pairwise data) on the RM-Bench dataset:</p>
<p><img alt="HelpSteer2 Pairwise Training RM-Bench Accuracy" src="../../../images/building_rm/helpsteer2_pairwise_training_RM-Bench_eval_accuracy.png" /></p>
<p><strong>RM-Bench Evaluation Results:</strong></p>
<ul>
<li><strong>Dataset</strong>: RM-Bench (different from training data)</li>
<li><strong>Model</strong>: Qwen2.5-14B trained on HelpSteer2 pairwise data</li>
<li><strong>Performance</strong>: Achieves ~62.5% accuracy on RM-Bench</li>
<li><strong>Training Progression</strong>: Consistent improvement from ~55.8% (baseline Qwen2.5-14B model capability at step 0) to 62.5% over 80+ steps</li>
</ul>
<p><strong>Key Insights:</strong></p>
<ol>
<li><strong>Cross-Dataset Generalization</strong>: The model trained on HelpSteer2 generalizes well to RM-Bench</li>
<li><strong>Performance Consistency</strong>: Similar accuracy levels across different evaluation datasets</li>
<li><strong>Robust Learning</strong>: Steady improvement curve indicates stable learning dynamics</li>
<li><strong>Practical Validation</strong>: Strong performance on an independent benchmark confirms model quality</li>
</ol>
<h4 id="practical-implications">Practical Implications</h4>
<ul>
<li><strong>Model Selection</strong>: Qwen3-14B recommended for production use due to better stability and performance</li>
<li><strong>Training Duration</strong>: Both models benefit from extended training (300+ steps)</li>
<li><strong>Performance Threshold</strong>: Both models exceed the 60% accuracy threshold for practical deployment</li>
<li><strong>Cross-Dataset Robustness</strong>: Models demonstrate good generalization across different preference datasets</li>
<li><strong>Resource Efficiency</strong>: The marginal improvement of Qwen3-14B may justify the additional computational cost</li>
</ul>
<hr />
<h2 id="core-component-details">🧩 Core Component Details</h2>
<h3 id="custom-training-dataset">Custom Training Dataset</h3>
<p>Complete implementation example of a custom training dataset:</p>
<pre><code class="language-python">class CustomTrainDataset(BaseTrainDataset):
    def __init__(self, *args, **kwargs):
        # Initialize reward module
        self.reward_module = YourRewardModule(
            name=&quot;custom_reward&quot;,
            template=YourTemplate,
            examples=self._get_examples(),
            llm=None,
        )
        super().__init__(*args, **kwargs)

    def _build_messages(self, example):
        # Build formatted messages
        result = self.reward_module.format(sample=example)
        return [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: result}]
</code></pre>
<blockquote>
<p><strong>Important Note: Reasoning Model Configuration</strong></p>
<p>When training reasoning reward models, pay attention to the following configuration:
- For reasoning models (e.g., Qwen3):
  - <code>apply_chat_template</code> with <code>enable_thinking=True</code>
  - <code>format</code> with <code>enable_thinking=False</code>
- For non-reasoning models:
  - <code>apply_chat_template</code> with <code>enable_thinking=False</code>
  - <code>format</code> with <code>enable_thinking=True</code></p>
</blockquote>
<h3 id="ppo-grpo-pipeline">PPO + GRPO Pipeline</h3>
<ol>
<li><strong>Data Loading</strong>: Ray workers read the dataset and build prompts + ground truth scores</li>
<li><strong>Generation</strong>: <strong>Actor</strong> uses VLLM to generate score predictions in batches</li>
<li><strong>Reward Calculation</strong>: <strong>RewardManager</strong> calls the custom reward_fn to get scalar rewards</li>
<li><strong>Advantage Estimation</strong>: <strong>GRPO Estimator</strong> computes advantages &amp; targets</li>
<li><strong>Policy Update</strong>: <strong>PPO</strong> updates the actor parameters, while the critic learns the value function</li>
</ol>
<hr />
<h2 id="training-monitoring">📊 Training Monitoring</h2>
<h3 id="logging-and-metrics">Logging and Metrics</h3>
<p>The training process logs to both <strong>Console</strong> and <strong>Weights &amp; Biases</strong>:</p>
<ul>
<li><strong>Console</strong>: Use <code>ray job logs &lt;job_id&gt; -f</code> for real-time logs</li>
<li><strong>WandB</strong>: Set <code>WANDB_API_KEY</code> and <code>WANDB_BASE_URL</code> environment variables to upload metrics automatically</li>
</ul>
<h3 id="key-monitoring-metrics">Key Monitoring Metrics</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Meaning</th>
<th>Target Range</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reward/mean</code></td>
<td>Mean reward of the current epoch</td>
<td>0.6 - 1.0</td>
</tr>
<tr>
<td><code>accuracy</code></td>
<td>Accuracy of score predictions</td>
<td>&gt; 0.7</td>
</tr>
<tr>
<td><code>kl_loss</code></td>
<td>KL divergence to the reference model</td>
<td>&lt; 0.1</td>
</tr>
</tbody>
</table>
<h3 id="training-curves">Training Curves</h3>
<p>Monitor the training progress through these key curves:</p>
<ul>
<li><strong>Training Reward Curve</strong>: Shows model learning progression on training data</li>
<li><strong>Validation Reward Curve</strong>: Indicates generalization performance</li>
<li><strong>Loss Curves</strong>: Track convergence of different loss components</li>
</ul>
<hr />
<h2 id="faq-troubleshooting">❓ FAQ &amp; Troubleshooting</h2>
<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>
<h4 id="1-num_samples0-error">1. <strong><code>num_samples=0</code> error</strong></h4>
<p><strong>Problem</strong>: The dataset is empty after filtering.</p>
<p><strong>Solution</strong>: Check whether <code>_build_messages</code> parses rows correctly:
   <code>python
   from examples.train.pointwise.dataset import PointwiseTrainDataset
   ds = PointwiseTrainDataset(...)
   print(len(ds))</code></p>
<h4 id="2-ray-connection-issues">2. <strong>Ray connection issues</strong></h4>
<p><strong>Problem</strong>: Ray can't connect to <code>127.0.0.1:8265</code></p>
<p><strong>Solution</strong>:
   - Ensure <code>ray start --head</code> has been run
   - Check that port 8265 is reachable
   - Update <code>--address</code> parameter in the training script</p>
<h4 id="3-out-of-memory-errors">3. <strong>Out of Memory Errors</strong></h4>
<p><strong>Problem</strong>: CUDA out of memory during training</p>
<p><strong>Solutions</strong>:
   - Lower <code>actor_rollout_ref.rollout.gpu_memory_utilization</code>
   - Reduce <code>data.train_batch_size</code> or <code>ppo_micro_batch_size_per_gpu</code>
   - Use gradient checkpointing if available</p>
<h4 id="4-reasoning-model-configuration-issues">4. <strong>Reasoning Model Configuration Issues</strong></h4>
<p><strong>Problem</strong>: Incorrect thinking/reasoning token handling</p>
<p><strong>Solution</strong>: For reasoning models (e.g., Qwen3):
   - <code>apply_chat_template</code> with <code>enable_thinking=True</code>
   - <code>format</code> with <code>enable_thinking=False</code></p>
<p>For non-reasoning models:
   - <code>apply_chat_template</code> with <code>enable_thinking=False</code>
   - <code>format</code> with <code>enable_thinking=True</code></p>
<h4 id="5-helpsteer2-specific-issues">5. <strong>HelpSteer2 Specific Issues</strong></h4>
<p><strong>Data Format Validation</strong>:
   <code>python
   import pandas as pd
   df = pd.read_parquet('helpsteer2_train.parquet')
   print(df.columns)
   print(df['helpfulness'].value_counts())  # For pointwise</code></p>
<p><strong>Score Range Configuration</strong>: HelpSteer2 uses 0-4 helpfulness scale, ensure <code>max_error = 4</code> is set correctly in <code>reward_fn.py</code>.</p>
<h3 id="performance-optimization-tips">Performance Optimization Tips</h3>
<ol>
<li><strong>Batch Size Tuning</strong>: Start with smaller batch sizes and gradually increase</li>
<li><strong>Memory Management</strong>: Monitor GPU memory usage with <code>nvidia-smi</code></li>
<li><strong>Ray Resource Allocation</strong>: Ensure proper CPU/GPU resource allocation across Ray workers</li>
<li><strong>Data Loading</strong>: Use efficient data formats (Parquet) and appropriate chunk sizes</li>
</ol>
<hr />
<h2 id="inference-evaluation">🧪 Inference &amp; Evaluation</h2>
<p>After training, look for <strong>LoRA</strong> or full weights in <code>checkpoints/&lt;TIMESTAMP&gt;/actor_latest</code>.</p>
<blockquote>
<p>For evaluation examples, check <code>external/verl/tests/e2e</code> or just load the weights for inference.</p>
</blockquote>
<hr />
<h2 id="related-resources">🔗 Related Resources</h2>
<h3 id="tutorial-documentation">Tutorial Documentation</h3>
<ul>
<li><strong><a href="../data/">Data Processing Tutorial</a></strong> - Comprehensive data handling techniques</li>
</ul>
<h3 id="framework-documentation">Framework Documentation</h3>
<ul>
<li><strong><a href="https://github.com/volcengine/verl">VERL Framework</a></strong>: Core training framework</li>
<li><strong><a href="https://docs.ray.io/">Ray Distributed</a></strong>: Distributed computing platform</li>
<li><strong><a href="https://docs.vllm.ai/">VLLM Inference</a></strong>: High-performance inference engine</li>
</ul>
<h3 id="dataset-resources">Dataset Resources</h3>
<ul>
<li><strong><a href="https://huggingface.co/datasets/nvidia/helpsteer2">HelpSteer2</a></strong>: Human preference dataset</li>
</ul>
<hr />
<h2 id="summary">📝 Summary</h2>
<p>This guide provides a complete workflow for training reward models using the VERL framework, including:</p>
<ol>
<li><strong>System Architecture Understanding</strong>: Core components and working principles</li>
<li><strong>Environment Configuration</strong>: Dependency installation and runtime setup</li>
<li><strong>Data Preparation</strong>: Download, conversion, and formatting</li>
<li><strong>Two Training Modes</strong>: Detailed implementation of Pointwise and Pairwise approaches</li>
<li><strong>Monitoring and Debugging</strong>: Key metrics and troubleshooting</li>
<li><strong>Best Practices</strong>: Performance optimization and configuration recommendations</li>
</ol>
<p>By following this guide, you can successfully train reward models tailored to your specific needs, whether for absolute scoring or preference comparison tasks.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>